<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<style>
    :root {
        font-family: 'Roboto Slab', serif;
        font-style: normal;
        font-weight: normal;
    }

    body {
        overflow-x: hidden;
        overflow-y: scroll;
        padding: 0;
        margin: 0;
        background: var(--tg-theme-secondary-bg-color);
    }

    .container {
        margin: 0 auto;
        width: min(100vw, 100vh);
    }

    .grid-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        padding: min(1vh, 1vw);
        width: calc(100% - min(2vh, 2vw));
    }

    .grid-item {
        overflow: hidden;
        padding: min(1vh, 1vw);
        text-align: center;
        overflow-wrap: break-word;
    }

    .subject {
        width: 100%;
        margin: 0 auto;
        height: min(26vw, 26vh);
        background: var(--tg-theme-bg-color);
        color: var(--tg-theme-text-color);
        font-size: min(3vw, 3vh);
        box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        transition-duration: 0.4s;
        border-radius: min(3vw, 3vh);
        vertical-align: middle;
        padding: min(4vw, 4vh);
        border-width: 0;
    }

    .subject.added {
        background: var(--tg-theme-button-color);
    }

    .delete-all {
        position: fixed;
        margin: 0 min(2vw, 2vh);
        top: min(2vw, 2vh);
        width: min(96vw, 96vh);
        border: 0;
        background: #e01717;
        color: white;
        border-radius: min(5vw, 5vh);
        height: min(16vw, 16vh);
        font-size: min(4vw, 4vh);
    }
</style>
<body>
<div class="container">
    <button class="delete-all" onclick="delete_all()" id="delete-all"><b>Очистить</b></button>
<div class="grid-container" id="grid-container">
    <div class="grid-item">
        <button class="subject" onclick="button_click('Английский язык')" id='Английский язык'>Английский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Китайский язык')" id='Китайский язык'>Китайский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Робототехника')" id='Робототехника'>Робототехника</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Арабский язык')" id='Арабский язык'>Арабский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Лингвистика')" id='Лингвистика'>Лингвистика</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Русский язык')" id='Русский язык'>Русский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Астрономия')" id='Астрономия'>Астрономия</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Литература')" id='Литература'>Литература</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Технология')" id='Технология'>Технология</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Биология')" id='Биология'>Биология</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Математика')" id='Математика'>Математика</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Физика')" id='Физика'>Физика</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('География')" id='География'>География</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Менеджмент')" id='Менеджмент'>Менеджмент</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Физическая культура')" id='Физическая культура'>Физическая культура</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('ИЗО')" id='ИЗО'>ИЗО</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Немецкий язык')" id='Немецкий язык'>Немецкий язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Французский язык')" id='Французский язык'>Французский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Информатика')" id='Информатика'>Информатика</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('ОБЖ')" id='ОБЖ'>ОБЖ</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Химия')" id='Химия'>Химия</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Искусство')" id='Искусство'>Искусство</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Обществознание')" id='Обществознание'>Обществознание</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Черчение')" id='Черчение'>Черчение</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Испанский язык')" id='Испанский язык'>Испанский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Основы предпринимательства')" id='Основы предпринимательства'>Основы предпринимательства</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Экология')" id='Экология'>Экология</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('История')" id='История'>История</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Право')" id='Право'>Право</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Экономика')" id='Экономика'>Экономика</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Итальянский язык')" id='Итальянский язык'>Итальянский язык</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Психология')" id='Психология'>Психология</button>
    </div>
    <div class="grid-item">
        <button class="subject" onclick="button_click('Японский язык')" id='Японский язык'>Японский язык</button>
    </div>
</div>
</div>
</body>
<script type="application/javascript">
    let chosen_count = 0;

    function check_chosen() {
        let button = document.getElementById("delete-all");
        let grid_container = document.getElementById("grid-container");
        if (chosen_count === 0) {
            button.style.display = "none";
            grid_container.style.marginTop = "0";
        } else {
            button.style.display = "";
            grid_container.style.marginTop = "min(20vw, 20vh)";
        }
    }

    function button_click(button_id) {
        let button = document.getElementById(button_id);
        if (button.classList.contains("added")) {
            button.classList.remove("added");
            chosen_count -= 1;
        } else {
            button.classList.add("added");
            chosen_count += 1;
        }
        check_chosen();
    }

    function delete_all() {
        let buttons = document.getElementsByClassName("subject");
        for (let i = 0; i < buttons.length; i += 1) {
            let button = buttons[i];
            if (button.classList.contains("added")) {
                button.classList.remove("added");
            }
        }
        chosen_count = 0;
        check_chosen();
    }

    {% for subject in subjects %}
    button_click('{{ subject }}');
    {% endfor %}
    check_chosen();

    let tg = window.Telegram.WebApp;
    tg.expand();
    tg.MainButton.color = "#0dbb00";
    tg.MainButton.text = "Сохранить";
    tg.MainButton.show();
    tg.onEvent('mainButtonClicked', function(){
        let chosen_subjects = [];
        let buttons = document.getElementsByClassName("subject");
        for (let i = 0; i < buttons.length; i += 1) {
            let button = buttons[i];
            if (button.classList.contains("added")) {
                chosen_subjects.push(button.innerText);
            }
        }
        let data = {
            subjects: chosen_subjects
        }
        tg.sendData(JSON.stringify(data));
    });
</script>
</html>
